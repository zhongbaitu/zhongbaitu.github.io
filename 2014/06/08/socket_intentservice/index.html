
 <!DOCTYPE HTML>
<html lang="chinese">
<head>
  <meta charset="UTF-8">
  
    <title>实现Socket Io和Service通信使用Notification通知 | 钟买能个人博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="钟买能">
    
    <meta name="description" content="首先，分清楚 Service 和 IntentService。
之前做的一个笔记：

http://hackeris.me/2014/02/01/android-notifications/

参考：
Service vs IntentService：

http://stackoverflow.c">
    
    
    
    
    
    <link rel="icon" href="/img/favicon.png">
    
    
    <link rel="apple-touch-icon" href="/img/me.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/me.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="钟买能个人博客" title="钟买能个人博客"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="钟买能个人博客">钟买能个人博客</a></h1>
				<h2 class="blog-motto">love . to love . to be love .</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/About">About</a></li>
					
						<li><a href="/Resume">Resume</a></li>
					
						<li><a href="/Works">Works</a></li>
					
					<li>
					
					<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" autocomplete="off" name="q" maxlength="20" placeholder="Search" />
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/06/08/socket_intentservice/" title="实现Socket Io和Service通信使用Notification通知" itemprop="url">实现Socket Io和Service通信使用Notification通知</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://hackeris.me" title="钟买能">钟买能</a>
    </p>
  <p class="article-time">
    <time datetime="2014-06-08T12:42:34.000Z" itemprop="datePublished">Jun 8 2014</time>
    Updated:<time datetime="2014-06-20T17:23:13.000Z" itemprop="dateModified">Jun 21 2014</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="# 之前做的一个笔记："><span class="toc-number">1.</span> <span class="toc-text">之前做的一个笔记：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="# 参考："><span class="toc-number">2.</span> <span class="toc-text">参考：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="# 开始 "><span class="toc-number">3.</span> <span class="toc-text">开始</span></a></li></ol>
		</div>
		
		<p>首先，分清楚 Service 和 IntentService。</p>
<h2 id=" 之前做的一个笔记：">之前做的一个笔记：</h2>
<blockquote>
<p><a href="http://hackeris.me/2014/02/01/android-notifications/">http://hackeris.me/2014/02/01/android-notifications/</a></p>
</blockquote>
<h2 id=" 参考：">参考：</h2>
<p>Service vs IntentService：</p>
<blockquote>
<p><a href="http://stackoverflow.com/questions/15524280/service-vs-intent-service" target="_blank">http://stackoverflow.com/questions/15524280/service-vs-intent-service</a></p>
</blockquote>
<p>一篇对比了 Service、Thread、IntentService、AsyncTask 四者关系的文章：</p>
<blockquote>
<p><a href="http://techtej.blogspot.com.es/2011/03/android-thread-constructspart-4.html" target="_blank">http://techtej.blogspot.com.es/2011/03/android-thread-constructspart-4.html</a></p>
</blockquote>
<p>安卓官方参考资料：</p>
<blockquote>
<p><a href="http://developer.android.com/training/run-background-service/create-service.html" target="_blank">http://developer.android.com/training/run-background-service/create-service.html</a></p>
</blockquote>
<h2 id=" 开始 ">开始</h2>
<p>由于 IntentService 比较方便所以就直接使用 IntentService 了。</p>
<p>新建类，继承 IntentService。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CallingService</span> <span class="keyword">extends</span> <span class="title">IntentService</span> {</span>

	<span class="keyword">public</span> <span class="title">CallingService</span>(String name) {
		<span class="keyword">super</span>(name);
		<span class="comment">// TODO Auto-generated constructor stub</span>
	}

	<span class="annotation">@Override</span>
	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onHandleIntent</span>(Intent intent) {
		<span class="comment">// TODO Auto-generated method stub</span>
		
		<span class="comment">//do work here</span>
		
		System.out.println(<span class="string">" 成功启动 "</span>);
	}

}
</pre></td></tr></table></figure>

<p>如果这样直接启动 Service 很容易会报 InstantiationException（就在这里卡了一会）<br>解决：</p>
<blockquote>
<p><a href="http://stackoverflow.com/questions/6176255/why-do-i-get-an-instantiationexception-if-i-try-to-start-a-service" target="_blank">http://stackoverflow.com/questions/6176255/why-do-i-get-an-instantiationexception-if-i-try-to-start-a-service</a></p>
</blockquote>
<p>只要把构造函数改改就 OK 了</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="keyword">public</span> <span class="title">CallingService</span>() {
	   <span class="keyword">super</span>(<span class="string">"CallingService"</span>);
}
</pre></td></tr></table></figure>

<p>启动 IntentService</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>Intent intent=<span class="keyword">new</span> Intent(<span class="keyword">this</span>, CallingService.<span class="keyword">class</span>);
startService(intent);
</pre></td></tr></table></figure>

<p>在这个 Service 实现一个内部类, 继承 IOCallback</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre></td><td class="code"><pre>class MySocketIO implements IOCallback  { 
	
	<span class="comment">// 构造函数</span>
	<span class="keyword">public</span> <span class="title">MySocketIO</span>(){

	}
	
	
	<span class="annotation">@Override</span>
	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDisconnect</span>() {
		<span class="comment">// TODO Auto-generated method stub</span>
		
	}

	<span class="annotation">@Override</span>
	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onConnect</span>() {
		<span class="comment">// TODO Auto-generated method stub</span>
		
	}

	<span class="annotation">@Override</span>
	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span>(String data, IOAcknowledge ack) {
		System.out.println(<span class="string">"Server said: "</span> + data);
		
	}

	<span class="annotation">@Override</span>
	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span>(JSONObject json, IOAcknowledge ack) {
		<span class="comment">// TODO Auto-generated method stub</span>
		
	}

	<span class="annotation">@Override</span>
	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span>(String event, IOAcknowledge ack, Object... args) {
		<span class="comment">// TODO Auto-generated method stub</span>
            
            <span class="comment">// 这里接收广播</span>
		
	}

	<span class="annotation">@Override</span>
	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span>(SocketIOException socketIOException) {
		<span class="comment">// TODO Auto-generated method stub</span>
		
	}

}
</pre></td></tr></table></figure>

<p>Notification 参考上一篇文章。</p>
<p>整个代码：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
</pre></td><td class="code"><pre><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CallingService</span> <span class="keyword">extends</span> <span class="title">IntentService</span> {</span>
	
	<span class="keyword">private</span> MySocketIO socket;
	<span class="keyword">long</span> vT[]={<span class="number">300</span>,<span class="number">100</span>,<span class="number">300</span>,<span class="number">100</span>};
	<span class="keyword">int</span> id, no;
	
	<span class="keyword">public</span> <span class="title">CallingService</span>() {
	    <span class="keyword">super</span>(<span class="string">"CallingService"</span>);
	}

	<span class="keyword">public</span> <span class="title">CallingService</span>(String name) {
		<span class="keyword">super</span>(name);
		
	}
	
    <span class="annotation">@Override</span>
    <span class="keyword">public</span> IBinder <span class="title">onBind</span>(Intent intent) { 
        Log.d(<span class="string">"test"</span>, <span class="string">"onBind()"</span>); 
        <span class="keyword">return</span> <span class="keyword">super</span>.onBind(intent); 
    } 
  
    <span class="annotation">@Override</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span>() { 
        Log.d(<span class="string">"test"</span>, <span class="string">"onCreate()"</span>); 
        <span class="keyword">super</span>.onCreate(); 
    } 
  
    <span class="annotation">@Override</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span>() { 
        Log.d(<span class="string">"test"</span>, <span class="string">"onDestroy()"</span>); 
        <span class="keyword">super</span>.onDestroy(); 
    } 
  
    <span class="annotation">@Override</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStart</span>(Intent intent, <span class="keyword">int</span> startId) { 
        Log.d(<span class="string">"test"</span>, <span class="string">"onStart()"</span>); 
        <span class="keyword">super</span>.onStart(intent, startId); 
    } 
  
    <span class="annotation">@Override</span>
    <span class="keyword">public</span> <span class="keyword">int</span> <span class="title">onStartCommand</span>(Intent intent, <span class="keyword">int</span> flags, <span class="keyword">int</span> startId) { 
        Log.d(<span class="string">"test"</span>, <span class="string">"onStartCommand()"</span>); 
        <span class="keyword">return</span> <span class="keyword">super</span>.onStartCommand(intent, flags, startId); 
    } 

	<span class="annotation">@Override</span> 
	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onHandleIntent</span>(Intent intent) {
		
		no = intent.getIntExtra(<span class="string">"no"</span>, -<span class="number">1</span>);
        id = intent.getIntExtra(<span class="string">"id"</span>, -<span class="number">1</span>);
        socket=<span class="keyword">new</span> MySocketIO(Common.LOCALHOST, id);
        initNotification(no);
	}
	
	<span class="javadoc">/**
	 * 
	 *<span class="javadoctag"> @param</span> Myno 拿到的号数
	 *<span class="javadoctag"> @param</span> nowNo 现在叫的号数
	 */</span>
	<span class="annotation">@SuppressLint</span>(<span class="string">"NewApi"</span>)
	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initNotification</span>(<span class="keyword">int</span> nowNo){
		
	Intent resultIntent = <span class="keyword">new</span> Intent(<span class="keyword">this</span>, MainPager.class);
	

	TaskStackBuilder stackBuilder = TaskStackBuilder.create(<span class="keyword">this</span>);
	
	stackBuilder.addNextIntent(resultIntent);

	PendingIntent resultPendingIntent = 
	                stackBuilder.getPendingIntent(
	                    <span class="number">0</span>,
	                    PendingIntent.FLAG_UPDATE_CURRENT
	                );

	NotificationCompat.Builder mBuilder =           <span class="comment">//Notification 的兼容类</span>
	
	                <span class="keyword">new</span> NotificationCompat.Builder(<span class="keyword">this</span>)
	
	                .setSmallIcon(R.drawable.ic_launcher)   <span class="comment">// 若没有设置 largeicon，此为左边的大 icon，设置了 largeicon，则为右下角的小 icon，无论怎样，都影响 Notifications area 显示的图标</span>
	
	                .setContentTitle(<span class="string">" 您的号数："</span>+no) <span class="comment">// 标题</span>
	
	                .setContentText(<span class="string">" 现叫号数："</span>+nowNo)         <span class="comment">// 正文</span>
	
	                .setOngoing(<span class="keyword">true</span>)      <span class="comment">//true 使 notification 变为 ongoing，用户不能手动清除，类似 QQ,false 或者不设置则为普通的通知</span>
	                
	                .setContentIntent(resultPendingIntent);      
	
	<span class="keyword">if</span>(no==nowNo){
		mBuilder.setVibrate(vT) ; <span class="comment">// 震动</span>
		mBuilder.setDefaults(Notification.DEFAULT_SOUND);<span class="comment">// 设置声音，此为默认声音</span>
		mBuilder.setAutoCancel(<span class="keyword">true</span>);<span class="comment">// 点击之后自动消失</span>
	}
				
	
	NotificationManager mNotificationManager =
            (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
	
	mNotificationManager.notify(<span class="number">1000</span>, mBuilder.build());


		}
	
	class MySocketIO implements IOCallback  { 

		<span class="keyword">public</span> SocketIO socket;

		<span class="javadoc">/**
		 * 企业 id
		 */</span>
		<span class="keyword">private</span> <span class="keyword">int</span> flag;
		
		<span class="comment">// 构造函数</span>
		<span class="keyword">public</span> <span class="title">MySocketIO</span>( String url,<span class="keyword">int</span> flag)
		{
			<span class="keyword">this</span>.flag=flag;
			socket = <span class="keyword">new</span> SocketIO();
			<span class="keyword">try</span> { 
				
				socket.connect(url, <span class="keyword">this</span>);
				
				
			} <span class="keyword">catch</span> (MalformedURLException e) {
				<span class="comment">// TODO Auto-generated catch block</span>
				e.printStackTrace();
			}
		}
		
		
		<span class="annotation">@Override</span>
		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDisconnect</span>() {
			<span class="comment">// TODO Auto-generated method stub</span>
			
		}

		<span class="annotation">@Override</span>
		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onConnect</span>() {
			<span class="comment">// TODO Auto-generated method stub</span>
			
		}

		<span class="annotation">@Override</span>
		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span>(String data, IOAcknowledge ack) {
			System.out.println(<span class="string">"Server said: "</span> + data);
			
		}

		<span class="annotation">@Override</span>
		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span>(JSONObject json, IOAcknowledge ack) {
			<span class="comment">// TODO Auto-generated method stub</span>
			
		}

		<span class="annotation">@Override</span>
		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span>(String event, IOAcknowledge ack, Object... args) {
			<span class="comment">// TODO Auto-generated method stub</span>
			<span class="keyword">if</span>(event.endsWith(<span class="string">"nowNumber"</span>) ){
				JSONObject object=<span class="keyword">null</span>;
				<span class="keyword">if</span>(args.length&gt;<span class="number">0</span>)
				{
					
					 <span class="keyword">try</span> {
						object=<span class="keyword">new</span> JSONObject(args[<span class="number">0</span>].toString());
					} <span class="keyword">catch</span> (JSONException e) {
						<span class="comment">// TODO Auto-generated catch block</span>
						e.printStackTrace();
					}
					
				}
				<span class="keyword">int</span> checkFlag = -<span class="number">1</span> ;
				<span class="keyword">try</span> {
					checkFlag=object.getInt(<span class="string">"id"</span>);
				} <span class="keyword">catch</span> (JSONException e1) {
					<span class="comment">// TODO Auto-generated catch block</span>
					e1.printStackTrace();
				}
				<span class="keyword">if</span>(checkFlag==(flag)){
					<span class="keyword">try</span> {
						
						initNotification(object.getInt(<span class="string">"no"</span>));
						Log.v(<span class="string">"test"</span>, object.getInt(<span class="string">"no"</span>)+<span class="string">""</span>);
					} <span class="keyword">catch</span> (JSONException e) {
						<span class="comment">// TODO Auto-generated catch block</span>
						e.printStackTrace();
					}

				}

			}
			
		}

		<span class="annotation">@Override</span>
		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span>(SocketIOException socketIOException) {
			<span class="comment">// TODO Auto-generated method stub</span>
			
		}

	}

}
</pre></td></tr></table></figure>

<hr>
<p><img src="http://zhongsir.qiniudn.com/2014-6-8/20140608204409.jpg" alt=""></p>
<p>实现 SocketIO 和 Service 通信使用 Notification 通知。</p>
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/android/">android</a>
  </div>


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/安卓网络开发/">安卓网络开发</a>
</div>



<div class="article-share" id="share">

  <div data-url="http://hackeris.me/2014/06/08/socket_intentservice/" data-title="实现Socket Io和Service通信使用Notification通知 | 钟买能个人博客" data-tsina="2162115292" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2014/06/21/volley/" title="一个异步网络通信框架——Volley">
  <strong>PREVIOUS:</strong><br/>
  <span>
  一个异步网络通信框架——Volley</span>
</a>
</div>


<div class="next">
<a href="/2014/05/31/androidroundimageview/"  title="安卓自定义圆形Image View">
 <strong>NEXT:</strong><br/> 
 <span>安卓自定义圆形Image View
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="# 之前做的一个笔记："><span class="toc-number">1.</span> <span class="toc-text">之前做的一个笔记：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="# 参考："><span class="toc-number">2.</span> <span class="toc-text">参考：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="# 开始 "><span class="toc-number">3.</span> <span class="toc-text">开始</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
			<li><a href="/categories/git版本控制/" title="git版本控制">git版本控制<sup>3</sup></a></li>
		
			<li><a href="/categories/java杂锦/" title="java杂锦">java杂锦<sup>1</sup></a></li>
		
			<li><a href="/categories/struts/" title="struts">struts<sup>2</sup></a></li>
		
			<li><a href="/categories/安卓前端开发/" title="安卓前端开发">安卓前端开发<sup>5</sup></a></li>
		
			<li><a href="/categories/安卓开发杂锦/" title="安卓开发杂锦">安卓开发杂锦<sup>4</sup></a></li>
		
			<li><a href="/categories/安卓网络开发/" title="安卓网络开发">安卓网络开发<sup>2</sup></a></li>
		
			<li><a href="/categories/生活点滴/" title="生活点滴">生活点滴<sup>8</sup></a></li>
		
			<li><a href="/categories/电脑常识杂锦/" title="电脑常识杂锦">电脑常识杂锦<sup>2</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			<li><a href="/tags/Git权威指南/" title="Git权威指南">Git权威指南<sup>2</sup></a></li>
		
			<li><a href="/tags/android/" title="android">android<sup>2</sup></a></li>
		
			<li><a href="/tags/git/" title="git">git<sup>3</sup></a></li>
		
			<li><a href="/tags/github/" title="github">github<sup>3</sup></a></li>
		
			<li><a href="/tags/hexo/" title="hexo">hexo<sup>1</sup></a></li>
		
			<li><a href="/tags/java/" title="java">java<sup>1</sup></a></li>
		
			<li><a href="/tags/java ee/" title="java ee">java ee<sup>2</sup></a></li>
		
			<li><a href="/tags/struts/" title="struts">struts<sup>2</sup></a></li>
		
			<li><a href="/tags/兼职/" title="兼职">兼职<sup>2</sup></a></li>
		
			<li><a href="/tags/大学/" title="大学">大学<sup>5</sup></a></li>
		
			<li><a href="/tags/安卓/" title="安卓">安卓<sup>9</sup></a></li>
		
			<li><a href="/tags/感悟/" title="感悟">感悟<sup>4</sup></a></li>
		
			<li><a href="/tags/毕设/" title="毕设">毕设<sup>2</sup></a></li>
		
			<li><a href="/tags/生活/" title="生活">生活<sup>6</sup></a></li>
		
			<li><a href="/tags/翻墙/" title="翻墙">翻墙<sup>1</sup></a></li>
		
			<li><a href="/tags/青春/" title="青春">青春<sup>2</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="null" target="_blank" title="rss">RSS</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hi ^_^  I am ZhongMaiNeng . I love to share anything here. <br/>
			for my collage . for coding . for traveling . for all my life.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2162115292" target="_blank" title="weibo"></a>
		
		
		
		<a href="https://github.com/zhongbaitu" target="_blank" title="github"></a>
		
		
	</div>
		<p class="copyright">Powered by <a href="http://zespia.tw/hexo/" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2014 
		
		<a href="http://hackeris.me" target="_blank" title="钟买能">钟买能</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"null"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>


<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-49779500-1', 'hackeris.me');  
ga('send', 'pageview');
</script>


  </body>
</html>
